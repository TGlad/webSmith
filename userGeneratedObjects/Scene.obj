saveChanges?description=This+is+a+container+that+has+all+the+objects+in+a+scene+as+components.+A+hierarchy+of+scenes+should+be+possible.&wikilink=&init=baseState%27s+interactions+%3D+%5B%5D%3B%0D%0Adown%27s+overlapPairs+%3D+%5B%5D%3B+%2F%2F+will+be+an+array+of+these+%5Bindex1%2C+index2%5D%0D%0Adown%27s+overlapFrustumIndices+%3D+%5B%5D%3B+%2F%2F+in-view%0D%0AbaseState.AABBs+%3D+%5B%5D%3B%0D%0AbaseState.objects+%3D+%5B%5D%3B%0D%0AbaseState.cameras+%3D+%5B%5D%3B%0D%0AbackIn.renderOBBs+%3D+%5B%5D%3B%0D%0AbackIn.frustums+%3D+%5B%5D%3B%0D%0AbackInSource.frustums+%3D+%5B%5D%3B%0D%0AbackInSource.AABBs+%3D+%5B%5D%3B%0D%0AbackInSource.renderOBBs+%3D+%5B%5D%3B%0D%0A%0D%0Athis.addObject+%3D+function%28object%29%0D%0A%7B%0D%0A++%2F%2F+we+don%27t+actually+add+the+object+but+rather%2C+we+add+an+AABB+that+uses+the+object%0D%0A++var+volume+%3D+new+BoxVolume%28%29%3B%0D%0A++g_addObject%28volume%2C+%7B+surrounds%3A+object+%7D%29%3B%0D%0A++this.baseState.AABBs.push%28volume%29%3B%0D%0A++this.backInSource.AABBs.push%28%7Bpointer%3Avolume.backOut%2C+name%3A%27AABB%27%7D%29%3B%0D%0A++this.backInSource.renderOBBs.push%28%7Bpointer%3Aobject.backOut%2C+name%3A%27renderOBB%27%7D%29%3B%0D%0A++this.baseState.objects.push%28object%29%3B%0D%0A%7D%0D%0Athis.addCamera+%3D+function%28camera%29%0D%0A%7B%0D%0A++this.baseState.cameras.push%28camera%29%3B%0D%0A++this.backInSource.frustums.push%28%7Bpointer%3Acamera.backOut%2C+name%3A%27frustum%27%7D%29%3B%0D%0A++var+view+%3D+new+View%28%29%3B%0D%0A++g_addObject%28view%2C+%7Bcamera%3A+camera%7D%29%3B%0D%0A++this.baseState.view+%3D+view%3B%0D%0A++this.outDest.objects+%3D+%7Bpointer%3Aview.in%2C+name%3A%27objects%27%7D%3B%0D%0A%7D%0D%0A%0D%0A&receive=for+%28key+in+down%29%0D%0A++down%5Bkey%5D+%3D+in%5Bkey%5D%3B&reply=for+%28key+in+up%29%0D%0A++backOut%5Bkey%5D+%3D+up%5Bkey%5D%3B%0D%0A&predict=&react=down%27s+overlapPairs+%3D+%5B%5D%3B+%2F%2F+clear+the+list%0D%0A%2F%2F%2F%2F+here+we+add+intersections%0D%0Afor+%28k%3D0%3B+k%3Cup%27s+AABBs%27s+length%3B+k%2B%2B%29%0D%0A%7B%0D%0A++if+%28not+up%27s+AABBs%5Bk%5D%29%0D%0A++++continue%3B%0D%0A++for+%28j+%3D+k%2B1%3B+j%3Cup%27s+AABBs%27s+length%3B+j%2B%2B%29%0D%0A++%7B%0D%0A++++if+%28not+up%27s+AABBs%5Bj%5D%29%0D%0A++++++continue%3B%0D%0A++++if+%28up%27s+AABBs%5Bk%5D+.overlaps+up%27s+AABBs%5Bj%5D%29%0D%0A++++%7B%0D%0A++++++%2F%2F+add+a+new+array+pair%0D%0A++++++down%27s+overlapPairs+.push+%5Bk%2C+j%5D%3B+%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0A%2F%2F+now+for+camera+overlap%0D%0Adown%27s+overlapFrustumIndices+%3D+%5B%5D%3B%0D%0Afor+%28i+in+up%27s+renderOBBs%29%0D%0A%7B%0D%0A++if+%28up%27s+renderOBBs%5Bi%5D+and+up%27s+frustums%5B0%5D+.overlaps+up%27s+renderOBBs%5Bi%5D%29%0D%0A++%7B%0D%0A++++down%27s+overlapFrustumIndices+.push+i%3B%0D%0A++%7D%0D%0A%7D%0D%0A&generate=%2F%2F+remove+interactions+that+have+gone+and+reduce+overlap+pairs+to+only+the+newly+added+ones%0D%0Afor+%28i+in+baseState%27s+interactions%29%0D%0A%7B%0D%0A++var+found+%3D+down%27s+overlapPairs+.indexOf+baseState%27s+interactions%5Bi%5D%3B%0D%0A++if+%28found%29%0D%0A++++down%27s+overlapPairs.splice%28found%2C+1%29%3B%0D%0A++else%0D%0A++%7B%0D%0A++++g_removeObject%28baseState%27s+interactions%5Bi%5D%29%3B%0D%0A++++baseState%27s+interactions.splice%28i%2C1%29%3B+%2F%2F+ie+remove%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0A%2F%2F+with+the+newly+added+pairs%2C+add+a+new+Interaction%0D%0Afor+%28i+in+down%27s+overlapPairs%29%0D%0A%7B%0D%0A++var+interaction+%3D+new+Interaction%28%29%3B%0D%0A++baseState%27s+interactions+.push+down%27s+overlapPairs%5Bi%5D%3B+%2F%2F+add+new%0D%0A++g_addObject%28interaction%2C+%7Bobject1%3A+baseState.objects%5Bdown%27s+overlapPairs%5Bi%5D%5B0%5D%5D%2C+object2%3A+baseState.objects%5Bdown%27s+overlapPairs%5Bi%5D%5B1%5D%5D%7D%29%3B+%0D%0A%7D+%0D%0A%0D%0A%2F%2F+now+add+some+sort+of+camera+interaction%0D%0A%2F%2F+clear+the+list+of+objects+to+read+from%0D%0Aout.objects+%3D+%5B%5D%3B%0D%0Afor+%28i+in+down%27s+overlapFrustumIndices%29%0D%0A++out.objects.push%28baseState.objects%5Bdown%27s+overlapFrustumIndices%5Bi%5D%5D.backOut%29%3B%0D%0A&analyse=for+%28key+in+backIn%29%0D%0A++up%5Bkey%5D+%3D+backIn%5Bkey%5D%3B+%2F%2F+keep+it+simple&save+as=Scene